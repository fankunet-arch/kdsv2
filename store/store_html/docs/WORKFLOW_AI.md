# 与 AI同事 协作约定（WORKFLOW_AI）

## 1. 适用范围
本约定适用于本项目下所有代码与数据库的分析、排查与修改工作，包括所有业务模块（如 POS、KDS、后台管理等）。

## 2. 代码与数据库基准
- 同一根目录名下的代码，以最新一版为唯一、排他性基准，历史版本全部作废。
- 所有分析和修改必须以真实代码和数据库结构为准，禁止凭空“幻想”新的实现。

## 3. 职责分工
- 用户只需提供：业务范围、模块路径、功能入口或错误现象（页面、按钮、接口、报错截图等），不要求精确到具体文件。
- AI同事 负责：
  - 从业务入口向下追踪调用链；
  - 找出涉及的 Controller / Service / Repository / Model / 前端组件 / 接口文件；
  - 在修改前用列表形式告知“本次操作涉及哪些文件和数据库表”。

## 4. 单次修改范围
- 每一次真正落地的修改，涉及的文件数不超过 2–3 个。
- 其他相关文件在当轮可以作为“只读分析”，不进行内容改写。
- 更大范围的调整应拆分为多轮迭代，每轮按本约定执行。

## 5. 修改流程
当 AI同事 需要修改某个文件时，应遵循：
1. 先贴出与问题相关的原始代码片段，用于核实当前真实状态；
2. 在原始片段基础上给出修改方案或 diff（尽量遵循“最小修改”原则）；
3. 如用户需要完整文件，再输出应用了上述修改后的完整文件内容，且不得省略代码、不写“略”。

## 6. 界面与样式约束
- 在仅为修复功能 / bug 的场景中，不得随意重写页面结构或样式：
  - 不得无必要地改动布局、组件层级、大面积样式；
  - 不得因为“猜测设计”而创建一套全新的界面实现。
- 如需大幅调整界面或样式，应单独作为“重构 / 改版”任务，由用户明确提出。

## 7. 数据库变更
- 默认以用户当前提供的数据库结构为最新基准。
- 对数据库结构的修改建议分两步进行：
  1. 先给出“表结构与代码使用的对照分析 + 调整方案”；
  2. 再按业务模块拆分，输出对应的完整变更 SQL 脚本。